using System;
using System.Collections.Generic;
using System.Linq;
using Microsoft.Xna.Framework;
using Microsoft.Xna.Framework.Audio;
using Microsoft.Xna.Framework.Content;
using Microsoft.Xna.Framework.GamerServices;
using Microsoft.Xna.Framework.Graphics;
using Microsoft.Xna.Framework.Input;
using Microsoft.Xna.Framework.Media;
using Microsoft.Xna.Framework.Net;
using Microsoft.Xna.Framework.Storage;


namespace PlatformerReading
{
  /// <summary>
  /// This is a game component that implements IUpdateable.
  /// </summary>
  public class AnimationPlayer
  {
    private Texture2D _heli;
    private Vector2 _animTextureOrigin = Vector2.Zero;
    private double _animFrameElapsed = 0.0;
    private int _animFrameNum = 0;

    private const int ANIM_FRAME_COUNT = 34;
    public AnimationPlayer()
    {
      // TODO: Construct any child components here
    }

    protected void LoadContent()
    {
      _heli = level.Content.Load<Texture2D>("1");
      _animTextureOrigin.X = (_heli.Width/2)/ANIM_FRAME_COUNT;
      _animTextureOrigin.Y = _heli.Height/2;
    }

    public override void Draw(GameTime gameTime,SpriteBatch spriteBatch)
    {
      spriteBatch.Begin();
      _animFrameElapsed += gameTime.ElapsedGameTime.TotalSeconds;

      if(_animFrameElapsed >= 0.05)
        {
          _animFrameNum = (_animFrameNum + 1)%ANIM_FRAME_COUNT;
          _animFrameElapsed = 0;
        }

      Rectangle sourceRectangle = new Rectangle(_animFrameNum*(_heli.Width/ANIM_FRAME_COUNT),0,_heli.Width/ANIM_FRAME_COUNT,_heli.Height);
      Vector2 position = new Vector2(100,100);//new Vector2(graphics.GraphicsDevice.Viewport.Width/2,graphics.GraphicsDevice.Viewport.Height/2);

      spriteBatch.Draw(_heli,position,sourceRectangle,Color.White,0.0f,_animTextureOrigin,1.0f,SpriteEffects.None,0.0f);
      spriteBatch.End();      
    }

  }
}